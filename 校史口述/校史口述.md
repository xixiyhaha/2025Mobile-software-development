# 2025年夏季《移动软件开发》实验报告



<center>姓名：邓林  学号：23020007014</center>

| 姓名和学号           | 邓林，23020007014                                            |
| -------------------- | ------------------------------------------------------------ |
| 本实验属于哪门课程？ | 中国海洋大学25夏《移动软件开发》                             |
| 实验名称？           | 实验4：视频播放小程序                                        |
| 博客地址？           | [2025年夏季《移动软件开发》实验报告4-CSDN博客](https://blog.csdn.net/2302_80269321/article/details/151116642?sharetype=blogdetail&sharerId=151116642&sharerefer=PC&sharesource=2302_80269321&spm=1011.2480.3001.8118) |
| Github仓库地址？     | https://github.com/xixiyhaha/2025Mobile-software-development.git |

（备注：将实验报告发布在博客、代码公开至 github 是 **加分项**，不是必须做的）



## **一、实验目标**

1、掌握视频列表的切换方法；

2、掌握视频自动播放方法；

3、掌握视 频随机颜色弹幕效果。



## 二、实验步骤

1、新建小程序并清空文件内容，建立新的文件页面，如图；

![image-20250902162358514](C:\Users\18501\AppData\Roaming\Typora\typora-user-images\image-20250902162358514.png)

2、设计导航栏`app.json`；

`{`

 `"pages": [`

  `"pages/index/index"`

 `],`

 `"window": {`

   `"navigationBarBackgroundColor": "#987938",`

   `"navigationBarTextStyle":"black",`

   `"navigationBarTitleText": "校史口述",`

   `"backgroundColor": "#eeeeee",`

   `"backgroundTextStyle":"light",`

   `"enablePullDownRefresh": false`

 `}`

`}`

3、页面分三个区域：视频播放器、弹幕发送区、视频列表，对他们分别进行页面设计：

`<!--index.wxml-->`

`<!--区域1：视频播放器-->`

`<video id='myVideo' controls></video>`

`<!--区域2：弹幕区域-->`
`<view class='danmuArea'>`
    `<input type='text' placeholder='请输入弹幕内容'></input>`
    `<button>发送弹幕</button>`
`</view>`
`<!--区域3：视频列表-->`
`<view class='videoList'>`
    `<view class='videoBar'>`
        `<text>biaoti</text>`
    `</view>`
`</view>`



`/* pages/index/index.wxss */`

`video {`

 `width: 100%;`

`}`

`.danmuArea {`

 `display: flex;`

 `flex-direction: row;`

`}`

`input {`

 `border: 1rpx solid #987938;`

 `height: 100rpx; /* 也可考虑使用 padding 和 line-height 组合来调整输入框的垂直居中 */`

 `flex-grow: 1;`

 `box-sizing: border-box; /* 确保边框和内边距包含在元素的总高度和宽度中 */`

`}`

`button {`

 `color: white;`

 `background-color: #987938;`

 `/* 建议增加以下样式以使按钮更美观 */`

 `padding: 10rpx 20rpx;`

 `border-radius: 8rpx;`

 `font-size: 28rpx;`

`}`

`/* 添加按钮的激活状态样式 */`

`button:active {`

 `background-color: #7a6130; /* 变深一些的颜色 */`

`}`

`.videoList {`

 `width: 100%;`

 `min-height: 400rpx;/*最小高度*/`

`}`

`.videoBar {`

 `width: 95%;` 

 `display: flex;`

 `flex-direction: row;`

 `flex-wrap: wrap; /* 添加换行属性，防止内容溢出 */`

 `border-bottom:1rpx solid #987938;`

 `margin:10rpx;/*外边距*/`

`}`

`image{`

  `width:70rpx;`

  `height:70rpx;`

  `margin:20rpx;`

`}`

`text{`

  `font-size:45rpx;`

  `color: #987938;`

  `margin:20rpx;`

  `flex-grow:1;/*扩张多余宽度*/`

`}`



`<!--index.wxml-->`

`<!--区域3：视频列表-->`
`<view class='videoList'>`
    `<view class='videoBar' wx:for='{{list}}' wx:key='video{{index}}'>`
        `<image src=''></image>`
        `<text>{{item.title}}</text>`
    `</view>`
`</view>`

<img src="C:\Users\18501\AppData\Roaming\Typora\typora-user-images\image-20250902110958640.png" alt="image-20250902110958640" style="zoom:50%;" />

4、将视频列表的视频组件设置为数组并进行循环展示；

`// pages/index/index.js`

`Page({`



 `/**`

  `\* 页面的初始数据`

  `*/`

 `data: {`

  `list:[`

​    `{`

​      `id:'001',`

​      `title:'视频1'`

​      `//videoUrl:'',`

​    `},`

​    `{`

​      `id:'002',`

​      `title:'视频2'`

​      `//videoUrl:'',`

​    `},`

​    `{`

​      `id:'003',`

​      `title:'视频3'`

​      `//videoUrl:'',`

​    `},`

​    `{`

​      `id:'004',`

​      `title:'视频4'`

​      `//videoUrl:'',`

​    `}`

  `]`

 `},`

<img src="C:\Users\18501\AppData\Roaming\Typora\typora-user-images\image-20250902111549479.png" alt="image-20250902111549479" style="zoom:50%;" />

5、播放设置逻辑实现；

**导入视频信息进入data中：**

 `data: {`

  `list: [{` 

​    `id: '1001',` 

​    `title: '杨国宜先生口述校史实录',` 

​    `videoUrl: 'http://arch.ahnu.edu.cn/__local/6/CB/D1/C2DF3FC847F4CE2ABB67034C595_025F0082_ABD7AE2.mp4?e=.mp4'` 

   `},` 

   `{` 

​    `id: '1002',` 

​    `title: '唐成伦先生口述校史实录',` 

​    `videoUrl: 'http://arch.ahnu.edu.cn/__local/E/31/EB/2F368A265E6C842BB6A63EE5F97_425ABEDD_7167F22.mp4?e=.mp4'` 

   `},` 

   `{` 

​    `id: '1003',` 

​    `title: '倪光明先生口述校史实录',` 

​    `videoUrl: 'http://arch.ahnu.edu.cn/__local/9/DC/3B/35687573BA2145023FDAEBAFE67_AAD8D222_925F3FF.mp4?e=.mp4'` 

   `},` 

   `{` 

​    `id: '1004',` 

​    `title: '吴仪兴先生口述校史实录',` 

​    `videoUrl: 'https://arch.ahnu.edu.cn/__local/5/DA/BD/7A27865731CF2B096E90B522005_A29CB142_6525BCF.mp4?e=.mp4'` 

​    `}` 

​    `] ,`

 `},`

**播放器添加控制视频地址**

`<!--区域1：视频播放器-->`

 `<video id='myVideo' controls src='{{src}}' enable-danmu danmu-btn></video>`

**视频列表添加各视频信息（标题、链接、序号等）**

`<!--区域3：视频列表-->`
`<view class='videoList'>`
    `<view class='videoBar' wx:for='{{list}}' wx:key='video{{index}}' data-url='{{item.videoUrl}}' bindtap='playVideo'>`
        `<image src='/images/play.png'></image>`
        `<text>{{item.title}}</text>`
    `</view>`
`</view>`



**定义`playVideo`视频播放函数：**

 `playVideo:function(e){`

  `this.videoCtx.stop()//停止当前播放视频`

  `this.setData({`

​    `src:e.currentTarget.dataset.url`

  `})//更新视频地址`

  `this.videoCtx.play()//播放新的视频`

`},`



**在Page模块中添加src属性**：`src:'',`

**监听页面加载，在onLoad中添加视频上下文，也就是我们的遥控器；**

 `/** * 生命周期函数--监听页面加载*/`

 `onLoad(options) {`

  `this.videoCtx=wx.createVideoContext('myVideo')`

 `},`

6、弹幕发送设置；

**弹幕区域绑定获取发弹幕和发送弹幕函数`getDanmu`、`sendDanmu`；**

`<!--区域2：弹幕区域-->`

`<view class='danmuArea'>`

  `<input type='text' placeholder='请输入弹幕内容' bindinput='getDanmu'></input>`

  `<button bindtap='sendDanmu'>发送弹幕</button>`

`</view>`



**`index.js`中定义两个函数：**

 `getDanmu:function(e){`

   `this.setData({`

​     `danmuTxt:e.detail.value`

   `})`

 `},`

 `sendDanmu:function(e){`

  `let text=this.data.danmuTxt`

  `this.videoCtx.sendDanmu({`

​    `text:text,`

​    `color:'red'`

  `})`

 `},`

**在Page模块中添加弹幕文本属性**：`danmuTxt:''`

7、弹幕颜色设置；

上述步骤固定弹幕颜色为红色，我们也可以将弹幕颜色设为随机：

在`pages/index/index.js`文件最上方添加`getRandomColor()`函数

`function getRandomColor(){`

  `let rgb = []`

  `for (let i = 0; i < 3; ++i){`

​    `let color = Math.floor(Math.random() * 256).toString(16)`

​    `color = (color.length == 1) ? '0' + color : color`

​    `rgb.push(color)`

  `}`

  `return '#' + rgb.join('')`

`}`

将`sendDanmu`中 `color:'red'`修改为`color:getRandomColor()`

## 三、程序运行结果

<img src="D:\xwechat_files\wxid_i46x014dxr9722_36bf\temp\RWTemp\2025-09\ab4e160c29f9c3a2c5590b5479ac6994\d4dfee86270b6d7a6c65ec8688688608.png" alt="d4dfee86270b6d7a6c65ec8688688608" style="zoom:33%;" />

## 四、问题总结与体会

描述实验过程中所遇到的问题，以及是如何解决的。有哪些收获和体会，对于课程的安排有哪些建议。

**收获和体会：**本次实验融入了更多模块与功能之间的绑定Bind，彼此的联动共同完成了播放视频和发送弹幕的功能。彩色弹幕借助随机数生成rgb颜色代码、使用数组自动读取每组视频信息，这些都让我对小程序应用有了更加深入的理解。

