<view class="container" style="--theme-color: {{themeColor || '#07c160'}};">
  <!-- 文件夹头部信息 -->
  <view class="folder-header">
    <view class="folder-name">{{folderInfo.name}}</view>
    <view class="folder-time">
      创建于 {{folderInfo.formattedCreateTime}}
    </view>
  </view>

  <!-- 功能按钮区域 -->
  <view class="function-buttons">
    <!-- 添加/更换伴奏 -->
    <button 
      class="func-btn" 
      bindtap="chooseAudio"
      wx:if="{{!audioFileID}}"
    >
      <icon type="audio" size="24" />
      <text>添加伴奏音频</text>
    </button>
    <button 
      class="func-btn" 
      bindtap="chooseAudio"
      wx:if="{{audioFileID}}"
    >
      <icon type="audio" size="24" />
      <text>更换伴奏音频</text>
    </button>

    <!-- 添加/更换歌词 -->
    <button 
      class="func-btn" 
      bindtap="chooseLyric"
      wx:if="{{!lyricContent}}"
    >
      <icon type="font" size="24" />
      <text>添加歌词</text>
    </button>
    <button 
      class="func-btn" 
      bindtap="chooseLyric"
      wx:if="{{lyricContent}}"
    >
      <icon type="font" size="24" />
      <text>更换歌词</text>
    </button>

    <!-- 添加视频（URL） -->
    <button 
    class="func-btn {{isAddingVideo ? 'disabled-btn' : ''}}" 
    bindtap="handleAddVideo"
    disabled="{{!canAddVideo || isAddingVideo}}"
  >
    <icon type="video" size="24" />
    <text>{{isAddingVideo ? '添加中...' : '添加视频(URL)'}}</text>
  </button>

    <!-- 录音按钮 -->
    <button 
      class="func-btn record-btn" 
      bindtap="startRecord"
      wx:if="{{!isRecording && audioFileID}}"
    >
      <icon type="mic" size="24" />
      <text>开始录音</text>
    </button>
    <button 
      class="func-btn stop-record-btn" 
      bindtap="stopRecord"
      wx:if="{{isRecording}}"
    >
      <icon type="stop" size="24" />
      <text>停止录音</text>
    </button>
  </view>

  <!-- 伴奏音频区域 -->
  <view class="section" wx:if="{{audioFileID}}">
  <view class="section-title">当前伴奏</view>
  
  <view class="accompaniment-card">
    <!-- 左侧封面 -->
    <view class="cover" bindtap="toggleAudioPlay">
      <image class="cover-img" src="{{audioPoster}}" />
      <view class="play-btn">
          <image wx:if="{{!isAudioPlaying}}" src="/images/tab/start.png" mode="aspectFit" style="width: 24px; height: 24px;"></image>
          <image wx:if="{{isAudioPlaying}}" src="/images/tab/pause.png" mode="aspectFit" style="width: 24px; height: 24px;"></image>
        </view>
    </view>

    <!-- 右侧信息 -->
    <view class="info" bindtap="toggleAudioPlay">
      <view class="title">{{audioName || '未上传伴奏'}}</view>
      <view class="meta">
        <text>{{formatTime(totalPlayTime)}}</text>
        <text>未知作者</text>
      </view>
    </view>
  </view>

  <!-- 删除按钮 -->
  <button class="delete-btn" bindtap="deleteAudio">删除伴奏</button>
</view>

  <!-- 无伴奏时显示提示 -->
  <view class="section" wx:if="{{!audioFileID}}">
    <view class="section-title">当前伴奏</view>
    <view class="empty-tip">暂无伴奏，请点击"添加伴奏音频"按钮上传</view>
  </view>

  <!-- 歌词区域 -->
  <view class="section" wx:if="{{lyricContent}}">
    <view class="section-title">当前歌词</view>
    <view class="lyric-container">
      <scroll-view 
        class="lyric-scroll" 
        scroll-y
        style="height: 200px;"
      >
        <view class="lyric-line" wx:for="{{lyricLines}}" wx:key="index">
          {{item}}
        </view>
      </scroll-view>
      <button 
        class="delete-btn" 
        bindtap="deleteLyric"
      >
        删除歌词
      </button>
    </view>
  </view>

  <!-- 录音列表区域 -->
<view class="section">
  <view class="section-title">录音列表 ({{recordList.length}})</view>

  <block wx:for="{{recordList}}" wx:key="recordId">
    <view class="record-card">

      <!-- 删除按钮放在卡片右上角 -->
      <button 
        class="record-delete-btn" 
        catchtap="deleteRecording" 
        data-record="{{item}}"
      >✕</button>
      
      <!-- 顶部：标题 -->
      <view class="record-header">
        <view class="record-title">{{item.name}}</view>
      </view>

      <!-- 中间：播放按钮 + 信息 -->
      <view class="record-body">
        <button 
            class="record-play-btn" 
            bindtap="playRecording" 
            data-recordid="{{item.recordId}}" 
            data-record="{{item}}"
          >
            <image wx:if="{{currentPlayRecord === item.recordId && isRecordPlaying}}" src="/images/tab/pause.png" mode="aspectFit" style="width: 24px; height: 24px;"></image>
            <image wx:else src="/images/tab/start.png" mode="aspectFit" style="width: 24px; height: 24px;"></image>
          </button>

        <view class="record-info">
          <view class="record-meta">
            <text>{{item.durationFromName}}</text>
            <text>{{item.formattedCreateTime}}</text>
          </view>

          <!-- 播放进度条 -->
          <view 
            class="progress-wrap" 
            data-recordid="{{item.recordId}}"
            bindtouchstart="onProgressTouchStart" 
            bindtouchmove="onProgressTouchMove" 
            bindtouchend="onProgressTouchEnd"
          >
            <view class="progress-bar" style="width: {{item.progressPercent}}%;"></view>
          </view>

          <!-- 当前时间 / 总时长 -->
          <view class="progress-time">
            {{formatTime(item.currentTime)}} / {{formatTime(item.totalDuration || item.duration || 0)}}
          </view>
        </view>
      </view>
    </view>
  </block>

  <view class="empty" wx:if="{{recordList.length === 0}}">{{audioFileID ? '暂无录音，点击"开始录音"按钮创建' : '暂无录音'}}</view>
</view>

  <!-- 视频列表区域 -->
  <view class="section">
  <!-- 显示视频个数 -->
  <view class="section-title">
    视频列表 ({{videoList.length}})
  </view>

  <block wx:for="{{videoList}}" wx:key="videoId">
    <view class="video-card" data-video="{{item}}" bindtap="navigateToVideoPlay">
      
      <!-- 删除按钮放在卡片右上角 -->
      <button class="video-delete-btn" catchtap="deleteVideo" data-videoid="{{item.videoId}}">✕</button>
      
      <!-- 封面 -->
      <view class="video-cover-wrap">
        <image class="video-cover" src="{{item.coverUrl}}" />
      </view>
      
      <!-- 信息 -->
      <view class="video-info">
        <view class="video-title">{{item.title}}</view>
        <view class="video-meta">{{item.platform}}</view>
      </view>
    </view>
  </block>

  <block wx:if="{{videoList.length === 0}}">
    <view class="empty">暂无视频</view>
  </block>
</view>

  
    
  <!-- 视频添加对话框 -->
  <view class="dialog-mask" wx:if="{{showVideoUrlDialog}}">
    <view class="dialog-container">
      <view class="dialog-title">添加视频</view>
      <input 
        class="dialog-input" 
        placeholder="粘贴视频链接" 
        value="{{videoUrl}}"
        bindinput="onVideoUrlInput"
      />
      <view class="dialog-buttons">
        <button class="dialog-btn cancel" bindtap="hideVideoUrlDialog">取消</button>
        <button class="dialog-btn confirm" bindtap="confirmAddVideo">添加</button>
      </view>
    </view>
  </view>
</view>